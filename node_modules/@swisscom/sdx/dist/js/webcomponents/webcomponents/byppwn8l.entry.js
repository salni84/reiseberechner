/*! Built with http://stenciljs.com */
const{h:t}=window.webcomponents;import{a as e}from"./chunk-16499f22.js";const i={aluminium:"#dde3e7","aluminium-tint-2":"#e4e9ec",horizon:"#eef3f6",turquoise:"#0eaba9",azure:"#1781e3",iris:"#5944c6",orchid:"#a63297",pink:"#e61e64",light:"rgba(0, 0, 0, .1)",dark:"rgba(255, 255, 255, .4)"};class a{constructor(){this.viewBox=34,this.radius=16,this.segmentPaddingForSizeSmall=0,this.segmentPaddingForSizeMedium=3,this.hundredPercent=2*this.radius*Math.PI,this.animationDuration=300,this.data=[],this.value="",this.legendPosition="bottom",this.size="medium",this.backgroundTheme="light",this.dataState=[]}dataChanged(){this.parseData()}componentWillLoad(){this.parseData()}animateSegment(t,e){t.circle&&e.add({targets:t.circle,begin:()=>{t.circle.style.display=""},"stroke-dasharray":`${t.width} ${this.hundredPercent}`,duration:this.animationDuration,easing:"easeInQuint"})}animateLegendItem(t,e){t&&e.add({targets:t,opacity:1,duration:this.animationDuration,easing:"easeInQuint"})}dataToSegments(){const t="medium"===this.size?this.segmentPaddingForSizeMedium:this.segmentPaddingForSizeSmall,e=this.dataState.reduce((t,e)=>t+e.value,0),i=this.dataState.filter(i=>i.value/e*this.hundredPercent<t),a=i.reduce((t,e)=>t+e.value,0),s=360/this.hundredPercent*t;let r=s;return this.dataState.filter(({},t)=>"small"!==this.size||0===t).map(n=>{let d=n.value/(e-a)*(this.hundredPercent-t*i.length);d<t?d=0:d-=t;const h={d:n,width:d,rotation:r};return r+=this.widthToDeg(h.width)+s,h})}widthToDeg(t){return 360/this.hundredPercent*t}getComponentClassNames(){return{component:!0,[this.legendPosition]:!0,[this.size]:!0,[this.backgroundTheme]:!0}}parseData(){if("string"==typeof this.data)try{this.dataState=JSON.parse(this.data)}catch(t){}else this.dataState=this.data}hasLabelsOrSrHints(){return this.dataState.some(this.hasLabelOrSrHint)}hasLabelOrSrHint(t){return!!t.label||!!t.srHint}getSegmentColor(t){return t&&t.color?i[t.color]:i[this.backgroundTheme]}render(){const i=this.viewBox/2,a=e.timeline(),s=e.timeline();return t("div",{class:this.getComponentClassNames()},t("div",{class:"wrapper"},t("div",{class:"chart-container"},t("div",{class:"chart"},"small"===this.size&&t("svg",{viewBox:`0 0 ${this.viewBox} ${this.viewBox}`,style:{transform:`rotate(${this.widthToDeg(this.hundredPercent)}deg)`}},t("circle",{"stroke-dasharray":`${this.hundredPercent} ${this.hundredPercent}`,stroke:this.getSegmentColor(),cx:i,cy:i,r:this.radius})),this.dataToSegments().map(e=>t("svg",{key:Math.random(),viewBox:`0 0 ${this.viewBox} ${this.viewBox}`,style:{transform:`rotate(${e.rotation}deg)`}},t("circle",{ref:t=>this.animateSegment(Object.assign({},e,{circle:t}),a),style:{display:"none"},"stroke-dasharray":`0 ${this.hundredPercent}`,stroke:this.getSegmentColor(e.d),cx:i,cy:i,r:this.radius})))),t("div",{class:"metadata","aria-hidden":"true"},t("div",{class:"value"},this.value),"small"!==this.size&&t("div",{class:"description"},this.description))),this.hasLabelsOrSrHints()&&t("ul",{class:{legend:!0,"sr-only":"small"===this.size}},this.dataState.filter(this.hasLabelOrSrHint).map(e=>t("li",{key:Math.random(),ref:t=>this.animateLegendItem(t,s),style:{opacity:"0"}},t("span",{"aria-hidden":"true"},t("sdx-icon",{"icon-name":"icon-record-filled",style:{color:this.getSegmentColor(e)}})," ",e.label),e.srHint&&t("span",{class:"sr-only"},e.srHint))))))}static get is(){return"sdx-pie-chart"}static get encapsulation(){return"shadow"}static get properties(){return{backgroundTheme:{type:String,attr:"background-theme"},data:{type:String,attr:"data",watchCallbacks:["dataChanged"]},dataState:{state:!0},description:{type:String,attr:"description"},legendPosition:{type:String,attr:"legend-position"},size:{type:String,attr:"size"},value:{type:String,attr:"value"}}}static get style(){return"\@charset \"UTF-8\";*,:after,:before,:host{-webkit-box-sizing:border-box;box-sizing:border-box}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}.component{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.component.small .wrapper .chart-container .chart{height:64px;width:64px}.component.small .wrapper .chart-container .chart svg{height:64px;width:64px;stroke-linecap:butt}.component.small .wrapper .chart-container .metadata{font-size:16px;top:8px;right:8px;bottom:8px;left:8px}.component.bottom .wrapper{-ms-flex-direction:column;flex-direction:column;-ms-flex-preferred-size:100%;flex-basis:100%}.component.bottom .wrapper .legend{margin-top:24px;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%}.component.bottom .wrapper .legend li:not(:last-of-type){margin-right:24px}.component.right .wrapper .legend{margin-left:32px;-ms-flex-direction:column;flex-direction:column}.component.right .wrapper .legend li:not(:last-of-type){margin-bottom:8px}.component.dark .wrapper .chart-container .metadata,.component.dark .wrapper .chart-container .metadata .description{color:#fff}.component .wrapper{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.component .wrapper .chart-container{position:relative}.component .wrapper .chart-container .chart{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);height:182px;width:182px}.component .wrapper .chart-container .chart svg{position:absolute;top:0;left:0;fill:transparent;stroke-width:2;stroke-linecap:round;height:182px;width:182px}.component .wrapper .chart-container .metadata{font-weight:400;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;line-height:28px;letter-spacing:-.89px;font-size:32px;position:absolute;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;top:32px;right:24px;bottom:24px;left:24px}.component .wrapper .chart-container .metadata .description{font-size:16px;color:#666;white-space:nowrap;width:100%;overflow:hidden;text-overflow:ellipsis;text-align:center}.component .wrapper .legend{display:-ms-flexbox;display:flex;list-style:none;padding:0;font-weight:300;-ms-flex-pack:center;justify-content:center;margin:0}.component .wrapper .legend li{white-space:nowrap}"}}export{a as SdxPieChart};