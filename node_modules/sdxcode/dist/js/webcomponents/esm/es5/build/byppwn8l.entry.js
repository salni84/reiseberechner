/*! Built with http://stenciljs.com */
import{h}from"../webcomponents.core.js";import{a as anime}from"./chunk-16499f22.js";var colors={aluminium:"#dde3e7","aluminium-tint-2":"#e4e9ec",horizon:"#eef3f6",turquoise:"#0eaba9",azure:"#1781e3",iris:"#5944c6",orchid:"#a63297",pink:"#e61e64",light:"rgba(0, 0, 0, .1)",dark:"rgba(255, 255, 255, .4)"},PieChart=function(){function t(){this.viewBox=34,this.radius=16,this.segmentPaddingForSizeSmall=0,this.segmentPaddingForSizeMedium=3,this.hundredPercent=2*this.radius*Math.PI,this.animationDuration=300,this.data=[],this.value="",this.legendPosition="bottom",this.size="medium",this.backgroundTheme="light",this.dataState=[]}return t.prototype.dataChanged=function(){this.parseData()},t.prototype.componentWillLoad=function(){this.parseData()},t.prototype.animateSegment=function(t,e){t.circle&&e.add({targets:t.circle,begin:function(){t.circle.style.display=""},"stroke-dasharray":t.width+" "+this.hundredPercent,duration:this.animationDuration,easing:"easeInQuint"})},t.prototype.animateLegendItem=function(t,e){t&&e.add({targets:t,opacity:1,duration:this.animationDuration,easing:"easeInQuint"})},t.prototype.dataToSegments=function(){var t=this,e="medium"===this.size?this.segmentPaddingForSizeMedium:this.segmentPaddingForSizeSmall,i=this.dataState.reduce(function(t,e){return t+e.value},0),r=this.dataState.filter(function(r){return r.value/i*t.hundredPercent<e}),a=r.reduce(function(t,e){return t+e.value},0),n=360/this.hundredPercent*e,s=n;return this.dataState.filter(function(e,i){return"small"!==t.size||0===i}).map(function(o){var d=o.value/(i-a)*(t.hundredPercent-e*r.length);d<e?d=0:d-=e;var h={d:o,width:d,rotation:s};return s+=t.widthToDeg(h.width)+n,h})},t.prototype.widthToDeg=function(t){return 360/this.hundredPercent*t},t.prototype.getComponentClassNames=function(){var t;return(t={component:!0})[this.legendPosition]=!0,t[this.size]=!0,t[this.backgroundTheme]=!0,t},t.prototype.parseData=function(){if("string"==typeof this.data)try{this.dataState=JSON.parse(this.data)}catch(t){}else this.dataState=this.data},t.prototype.hasLabelsOrSrHints=function(){return this.dataState.some(this.hasLabelOrSrHint)},t.prototype.hasLabelOrSrHint=function(t){return!!t.label||!!t.srHint},t.prototype.getSegmentColor=function(t){return t&&t.color?colors[t.color]:colors[this.backgroundTheme]},t.prototype.render=function(){var t=this,e=this.viewBox/2,i=anime.timeline(),r=anime.timeline();return h("div",{class:this.getComponentClassNames()},h("div",{class:"wrapper"},h("div",{class:"chart-container"},h("div",{class:"chart"},"small"===this.size&&h("svg",{viewBox:"0 0 "+this.viewBox+" "+this.viewBox,style:{transform:"rotate("+this.widthToDeg(this.hundredPercent)+"deg)"}},h("circle",{"stroke-dasharray":this.hundredPercent+" "+this.hundredPercent,stroke:this.getSegmentColor(),cx:e,cy:e,r:this.radius})),this.dataToSegments().map(function(r){return h("svg",{key:Math.random(),viewBox:"0 0 "+t.viewBox+" "+t.viewBox,style:{transform:"rotate("+r.rotation+"deg)"}},h("circle",{ref:function(e){return t.animateSegment(Object.assign({},r,{circle:e}),i)},style:{display:"none"},"stroke-dasharray":"0 "+t.hundredPercent,stroke:t.getSegmentColor(r.d),cx:e,cy:e,r:t.radius}))})),h("div",{class:"metadata","aria-hidden":"true"},h("div",{class:"value"},this.value),"small"!==this.size&&h("div",{class:"description"},this.description))),this.hasLabelsOrSrHints()&&h("ul",{class:{legend:!0,"sr-only":"small"===this.size}},this.dataState.filter(this.hasLabelOrSrHint).map(function(e){return h("li",{key:Math.random(),ref:function(e){return t.animateLegendItem(e,r)},style:{opacity:"0"}},h("span",{"aria-hidden":"true"},h("sdx-icon",{"icon-name":"icon-record-filled",style:{color:t.getSegmentColor(e)}})," ",e.label),e.srHint&&h("span",{class:"sr-only"},e.srHint))}))))},Object.defineProperty(t,"is",{get:function(){return"sdx-pie-chart"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{backgroundTheme:{type:String,attr:"background-theme"},data:{type:String,attr:"data",watchCallbacks:["dataChanged"]},dataState:{state:!0},description:{type:String,attr:"description"},legendPosition:{type:String,attr:"legend-position"},size:{type:String,attr:"size"},value:{type:String,attr:"value"}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"\@charset \"UTF-8\";*,:after,:before,:host{-webkit-box-sizing:border-box;box-sizing:border-box}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}.component{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.component.small .wrapper .chart-container .chart{height:64px;width:64px}.component.small .wrapper .chart-container .chart svg{height:64px;width:64px;stroke-linecap:butt}.component.small .wrapper .chart-container .metadata{font-size:16px;top:8px;right:8px;bottom:8px;left:8px}.component.bottom .wrapper{-ms-flex-direction:column;flex-direction:column;-ms-flex-preferred-size:100%;flex-basis:100%}.component.bottom .wrapper .legend{margin-top:24px;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%}.component.bottom .wrapper .legend li:not(:last-of-type){margin-right:24px}.component.right .wrapper .legend{margin-left:32px;-ms-flex-direction:column;flex-direction:column}.component.right .wrapper .legend li:not(:last-of-type){margin-bottom:8px}.component.dark .wrapper .chart-container .metadata,.component.dark .wrapper .chart-container .metadata .description{color:#fff}.component .wrapper{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.component .wrapper .chart-container{position:relative}.component .wrapper .chart-container .chart{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);height:182px;width:182px}.component .wrapper .chart-container .chart svg{position:absolute;top:0;left:0;fill:transparent;stroke-width:2;stroke-linecap:round;height:182px;width:182px}.component .wrapper .chart-container .metadata{font-weight:400;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;line-height:28px;letter-spacing:-.89px;font-size:32px;position:absolute;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;top:32px;right:24px;bottom:24px;left:24px}.component .wrapper .chart-container .metadata .description{font-size:16px;color:#666;white-space:nowrap;width:100%;overflow:hidden;text-overflow:ellipsis;text-align:center}.component .wrapper .legend{display:-ms-flexbox;display:flex;list-style:none;padding:0;font-weight:300;-ms-flex-pack:center;justify-content:center;margin:0}.component .wrapper .legend li{white-space:nowrap}"},enumerable:!0,configurable:!0}),t}();export{PieChart as SdxPieChart};